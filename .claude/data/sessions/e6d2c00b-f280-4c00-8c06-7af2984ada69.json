{
  "session_id": "e6d2c00b-f280-4c00-8c06-7af2984ada69",
  "prompts": [
    "Ready. Awaiting instructions.",
    "Create CodeRabbit Integration Implementation Plan\n\nCreate a comprehensive, step-by-step implementation plan for installing and integrating CodeRabbit CLI into MAO (Multi-Agent Orchestrator) on Anthropic Claude.\n\n**Output Location:** `/Users/sem/mao-Z/docs/CODERABBIT_IMPLEMENTATION_PLAN.md`\n\n**Plan Structure:**\n\n## 1. Overview\n- What is CodeRabbit CLI\n- Why integrate with MAO\n- Benefits for multi-agent workflows\n- Prerequisites\n\n## 2. Installation Steps\n### 2.1 Install CodeRabbit CLI\n```bash\n# Installation command\ncurl -fsSL https://cli.coderabbit.ai/install.sh | sh\n\n# Verify installation\ncoderabbit --version\n```\n\n### 2.2 Authentication Setup\n```bash\n# Login to CodeRabbit\ncoderabbit auth login\n# Follow browser redirect and copy access token\n```\n\n### 2.3 Verify Access\n```bash\n# Test basic review\ncd /path/to/project\ncoderabbit --prompt-only\n```\n\n## 3. Custom Tool Implementation\n### 3.1 Tool Architecture\n- MCP server pattern using Claude Agent SDK\n- Tool definition with proper schema\n- Async execution support\n- Error handling and timeout management\n\n### 3.2 Implementation Files\n- `/Users/sem/mao-Z/apps/orchestrator_3_stream/backend/modules/tools/coderabbit_tool.py`\n- Integration with AgentManager\n- Configuration in config.py\n\n### 3.3 Tool Interface\n```python\n@tool\ndef run_coderabbit_review(\n    review_type: str = \"all\",\n    output_mode: str = \"prompt-only\",\n    base_branch: Optional[str] = None,\n    config_files: Optional[List[str]] = None,\n    working_directory: Optional[str] = None\n) -> Dict[str, Any]\n```\n\n## 4. Configuration\n### 4.1 Environment Variables\nAdd to root `.env`:\n```bash\nCODERABBIT_CLI_PATH=/Users/sem/.local/bin/coderabbit\nCODERABBIT_ENABLED=true\nCODERABBIT_TIMEOUT=1800000  # 30 minutes in ms\n```\n\n### 4.2 Agent Configuration\n- Enable CodeRabbit tool for specific agents\n- test-validator agent configuration\n- review-agent configuration\n\n## 5. Integration with Existing Agents\n### 5.1 test-validator Agent\n- Add CodeRabbit tool to toolset\n- Pre-commit review workflows\n- Fix validation loops\n\n### 5.2 review-agent (if exists)\n- Code review orchestration\n- Multi-pass review cycles\n- Critical issue prioritization\n\n## 6. Usage Workflows\n### 6.1 Basic Review Workflow\n```\nUser: Tell test-validator to review uncommitted changes\nOrchestrator: [Commands test-validator with run_coderabbit_review]\ntest-validator: [Reviews code, reports findings]\n```\n\n### 6.2 Review + Fix Loop\n```\nUser: Have test-validator review and fix critical issues\ntest-validator: \n  1. Run CodeRabbit review\n  2. Identify 3 critical issues\n  3. Apply fixes\n  4. Re-run CodeRabbit to verify\n  5. Report completion\n```\n\n### 6.3 Pre-Commit Gate\n```\nUser: Create a pre-commit agent that blocks on critical issues\nOrchestrator: [Creates specialized agent with CodeRabbit tool]\npre-commit-agent: [Runs review, blocks commit if critical issues found]\n```\n\n## 7. Testing Strategy\n### 7.1 Unit Tests\n- Test tool execution\n- Test output parsing\n- Test timeout handling\n- Test error scenarios\n\n### 7.2 Integration Tests\n- Test with real repository\n- Test with different review types\n- Test background execution\n- Test agent coordination\n\n### 7.3 Test Script\nCreate `/Users/sem/mao-Z/apps/orchestrator_3_stream/backend/test_coderabbit_tool.py`\n\n## 8. Pricing Considerations\n### 8.1 Free Tier\n- 1 review per hour\n- Basic static analysis\n- Good for trying out\n\n### 8.2 Paid Plans\n- Pro: 5 reviews per hour\n- Lite: 1 review per hour\n- Learnings-powered reviews\n- Team standards enforcement\n\n### 8.3 Cost-Benefit Analysis\n- When to use CodeRabbit vs manual review\n- Integration with CI/CD\n- Team productivity gains\n\n## 9. Best Practices\n### 9.1 Agent Prompts\n- Use `--prompt-only` for AI agents\n- Set appropriate timeouts\n- Handle long-running reviews in background\n\n### 9.2 Review Loops\n- Limit to 2-3 iterations\n- Focus on critical issues first\n- Ignore nits in automated loops\n\n### 9.3 Error Handling\n- Timeout management\n- Rate limit handling\n- Authentication errors\n- Network failures\n\n## 10. Troubleshooting\n### 10.1 Common Issues\n- Authentication failures\n- Timeout errors\n- Rate limit exceeded\n- Git repository not found\n\n### 10.2 Debug Commands\n- Check CLI installation\n- Verify authentication\n- Test manual review\n- Check logs\n\n## 11. Rollout Plan\n### Phase 1: Installation & Testing\n- Install CLI\n- Test authentication\n- Manual testing with sample repos\n\n### Phase 2: Tool Implementation\n- Create custom tool\n- Unit tests\n- Integration tests\n\n### Phase 3: Agent Integration\n- Add to test-validator\n- Test basic workflows\n- Document usage\n\n### Phase 4: Production Rollout\n- Update documentation\n- Train users\n- Monitor usage\n- Gather feedback\n\n## 12. Success Metrics\n- Number of issues caught pre-commit\n- Reduction in PR review time\n- Code quality improvements\n- Developer satisfaction\n\n## 13. Future Enhancements\n- Custom review templates\n- Team-specific rules\n- Integration with GitHub Actions\n- Slack notifications for critical issues\n\n**Format:** Use clear markdown with code blocks, examples, and step-by-step instructions. Make it executable by another agent with minimal context.\n\n**Audience:** This plan will be shared with agents in other MAO instances, so be explicit about paths, commands, and configuration details."
  ],
  "agent_name": "Meridian"
}